---
openapi: "3.0.0"
info:
  title: Kokos Micro Executor (Node) API
  description: Api Docs
  version: 2.0.0
servers:
  - url: /
paths:

  /api/v1/livez:
    get:
      tags:
        - health
      operationId: Livez
      responses:
        default:
          description: no description
        "200":
          description: OK

  /api/v1/readyz:
    get:
      tags:
        - health
      operationId: Readyz
      responses:
        default:
          description: no description
        "200":
          description: OK

  /api/v1/executeFun:
    post:
      tags:
        - execution
      operationId: ExecuteFun
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExecuteFunPayload"
      responses:
        default:
          description: SmeupDataStructure
        "200":
          description: OK

  /api/v2/livez:
    get:
      tags:
        - health
      operationId: LivezV2
      responses:
        default:
          description: no description
        "200":
          description: OK

  /api/v2/readyz:
    get:
      tags:
        - health
      operationId: ReadyzV2
      responses:
        default:
          description: no description
        "200":
          description: OK

  /api/v2/executeFun:
    post:
      tags:
        - execution
      operationId: ExecuteFunV2
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExecuteFunPayload"
      responses:
        default:
          description: SmeupDataStructure
        "200":
          description: OK


components:
  schemas:
    ExecuteFunPayload:
      type: object
      properties:
        fun:
          $ref: '#/components/schemas/Fun'
        context:
          $ref: '#/components/schemas/ExecutionContext'


    Fun:
      type: object
      properties:
        component:
          type: string
        service:
          type: string
        function:
          type: string
        obj1:
          $ref: '#/components/schemas/FunObject'
        obj2:
          $ref: '#/components/schemas/FunObject'
        obj3:
          $ref: '#/components/schemas/FunObject'
        obj4:
          $ref: '#/components/schemas/FunObject'
        obj5:
          $ref: '#/components/schemas/FunObject'
        obj6:
          $ref: '#/components/schemas/FunObject'
        P:
          type: string
        INPUT:
          type: string


    FunObject:
      type: object
      properties:
        t:
          type: string
        p:
          type: string
        k:
          type: string


    ExecutionContext:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/KokosUser'
        env:
          $ref: '#/components/schemas/Environment'


    KokosUser:
      type: object
      properties:
        sessionId:
          type: string
        username:
          type: string
        environment:
          type: string
        device:
          type: string


    Environment:
      type: object
      properties:
        libraries:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/SourceLibrary'
        configs:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Config'
        registry:
          $ref: '#/components/schemas/Registry'


    SourceLibrary:
      type: object
      properties:
        repo:
          type: string
        path:
          type: string


    Config:
      type: object
      properties:
        path:
          type: string


    Registry:
      type: object
      properties:
        handlers:
          type: object
          additionalProperties:
            type: string
        services:
          type: object
          additionalProperties:
            type: string
        aliases:
          type: object
          additionalProperties:
            type: string